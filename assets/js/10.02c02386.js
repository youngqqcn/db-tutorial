(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{507:function(a,t,s){"use strict";s.r(t);var n=s(33),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"ç‰ˆæœ¬ç®¡ç†ä¸­é—´ä»¶-flyway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç‰ˆæœ¬ç®¡ç†ä¸­é—´ä»¶-flyway"}},[a._v("#")]),a._v(" ç‰ˆæœ¬ç®¡ç†ä¸­é—´ä»¶ Flyway")]),a._v(" "),s("blockquote",[s("p",[a._v("Flyway æ˜¯ä¸€ä¸ªæ•°æ®è¿ç§»å·¥å…·ã€‚")])]),a._v(" "),s("h2",{attrs:{id:"ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[a._v("#")]),a._v(" ç®€ä»‹")]),a._v(" "),s("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯-flyway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯-flyway"}},[a._v("#")]),a._v(" ä»€ä¹ˆæ˜¯ Flyway")]),a._v(" "),s("p",[s("strong",[a._v("Flyway æ˜¯ä¸€ä¸ªå¼€æºçš„æ•°æ®åº“è¿ç§»å·¥å…·ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»"}},[a._v("#")]),a._v(" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®è¿ç§»")]),a._v(" "),s("p",[a._v("ä¸ºäº†è¯´æ˜æ•°æ®è¿ç§»çš„ä½œç”¨ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªç¤ºä¾‹ï¼š")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰å‡è®¾ï¼Œæœ‰ä¸€ä¸ªå«åš Shiny çš„é¡¹ç›®ï¼Œå®ƒçš„æ¶æ„æ˜¯ä¸€ä¸ªå«åš Shiny Soft çš„ App è¿æ¥å«åš Shiny DB çš„æ•°æ®åº“ã€‚")]),a._v(" "),s("p",[a._v("ï¼ˆ2ï¼‰å¯¹äºå¤§å¤šæ•°é¡¹ç›®è€Œè¨€ï¼Œæœ€ç®€å•çš„æŒç»­é›†æˆåœºæ™¯å¦‚ä¸‹æ‰€ç¤ºï¼š")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://flywaydb.org/assets/balsamiq/Environments.png",alt:"img"}})]),a._v(" "),s("p",[a._v("è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸ä»…ä»…è¦å¤„ç†ä¸€ä»½ç¯å¢ƒä¸­çš„ä¿®æ”¹ï¼Œç”±æ­¤ä¼šå¼•å…¥ä¸€äº›ç‰ˆæœ¬å†²çªé—®é¢˜ï¼š")]),a._v(" "),s("p",[a._v("åœ¨ä»£ç ä¾§ï¼ˆå³åº”ç”¨è½¯ä»¶ï¼‰çš„ç‰ˆæœ¬é—®é¢˜æ¯”è¾ƒå®¹æ˜“è§£å†³ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("æœ‰æ–¹ä¾¿çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·")]),a._v(" "),s("li",[a._v("æœ‰å¯å¤ç”¨çš„æ„å»ºå’ŒæŒç»­é›†æˆ")]),a._v(" "),s("li",[a._v("è§„èŒƒçš„å‘å¸ƒå’Œéƒ¨ç½²è¿‡ç¨‹")])]),a._v(" "),s("p",[a._v("é‚£ä¹ˆï¼Œæ•°æ®åº“å±‚é¢çš„ç‰ˆæœ¬é—®é¢˜å¦‚ä½•è§£å†³å‘¢ï¼Ÿ")]),a._v(" "),s("p",[a._v("ç›®å‰ä»ç„¶æ²¡æœ‰æ–¹ä¾¿çš„æ•°æ®åº“ç‰ˆæœ¬å·¥å…·ã€‚è®¸å¤šé¡¹ç›®ä»ä½¿ç”¨ sql è„šæœ¬æ¥è§£å†³ç‰ˆæœ¬å†²çªï¼Œç”šè‡³æ˜¯é‡åˆ°å†²çªé—®é¢˜æ—¶æ‰æƒ³èµ·ç”¨ sql è¯­å¥å»è§£å†³ã€‚")]),a._v(" "),s("p",[a._v("ç”±æ­¤ï¼Œå¼•å‘ä¸€äº›é—®é¢˜ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("æœºå™¨ä¸Šçš„æ•°æ®åº“æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ")]),a._v(" "),s("li",[a._v("è„šæœ¬åˆ°åº•ç”Ÿæ•ˆæ²¡æœ‰ï¼Ÿ")]),a._v(" "),s("li",[a._v("ç”Ÿäº§ç¯å¢ƒä¿®å¤çš„é—®é¢˜æ˜¯å¦ä¹Ÿåœ¨æµ‹è¯•ç¯å¢ƒä¿®å¤äº†ï¼Ÿ")]),a._v(" "),s("li",[a._v("å¦‚ä½•å»ºç«‹ä¸€ä¸ªæ–°çš„æ•°æ®åº“å®ä¾‹ï¼Ÿ")])]),a._v(" "),s("p",[a._v("æ•°æ®è¿ç§»å°±æ˜¯ç”¨æ¥æå®šè¿™äº›æ··ä¹±çš„é—®é¢˜ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("é€šè¿‡è‰ç¨¿é‡å»ºä¸€ä¸ªæ•°æ®åº“ã€‚")]),a._v(" "),s("li",[a._v("åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥æ¸…æ¥šçš„äº†è§£æ•°æ®åº“çš„çŠ¶æ€ã€‚")]),a._v(" "),s("li",[a._v("ä»¥ä¸€ç§æ˜ç¡®çš„æ–¹å¼å°†æ•°æ®åº“ä»å½“å‰ç‰ˆæœ¬è¿ç§»åˆ°ä¸€ä¸ªæ–°ç‰ˆæœ¬ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"flyway-å¦‚ä½•å·¥ä½œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flyway-å¦‚ä½•å·¥ä½œ"}},[a._v("#")]),a._v(" Flyway å¦‚ä½•å·¥ä½œï¼Ÿ")]),a._v(" "),s("p",[a._v("æœ€ç®€å•çš„åœºæ™¯æ˜¯æŒ‡å®š Flyway è¿ç§»åˆ°ä¸€ä¸ªç©ºçš„æ•°æ®åº“ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-bb6e9f39e56ebbda.png",alt:"img"}})]),a._v(" "),s("p",[a._v("Flyway ä¼šå°è¯•æŸ¥æ‰¾å®ƒçš„ schema å†å²è¡¨ï¼Œå¦‚æœæ•°æ®åº“æ˜¯ç©ºçš„ï¼ŒFlyway å°±ä¸å†æŸ¥æ‰¾ï¼Œè€Œæ˜¯ç›´æ¥åˆ›å»ºæ•°æ®åº“ã€‚")]),a._v(" "),s("p",[a._v("ç°å†ä½ å°±æœ‰äº†ä¸€ä¸ªä»…åŒ…å«ä¸€å¼ ç©ºè¡¨çš„æ•°æ®åº“ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™å¼ è¡¨å« "),s("strong",[a._v("flyway_schema_history")]),a._v("ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-410eb31c6313b389.png",alt:"img"}})]),a._v(" "),s("p",[a._v("è¿™å¼ è¡¨å°†è¢«ç”¨äºè¿½è¸ªæ•°æ®åº“çš„çŠ¶æ€ã€‚")]),a._v(" "),s("p",[a._v("ç„¶åï¼ŒFlyway å°†å¼€å§‹æ‰«ææ–‡ä»¶ç³»ç»Ÿæˆ–åº”ç”¨ classpath ä¸­çš„ "),s("strong",[a._v("migrations")]),a._v("ã€‚è¿™äº› "),s("strong",[a._v("migrations")]),a._v(" å¯ä»¥æ˜¯ sql æˆ– javaã€‚")]),a._v(" "),s("p",[a._v("è¿™äº› "),s("strong",[a._v("migrations")]),a._v(" å°†æ ¹æ®ä»–ä»¬çš„ç‰ˆæœ¬å·è¿›è¡Œæ’åºã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-d36ee07ada4efbcd.png",alt:"img"}})]),a._v(" "),s("p",[a._v("ä»»æ„ migration åº”ç”¨åï¼Œschema å†å²è¡¨å°†æ›´æ–°ã€‚å½“å…ƒæ•°æ®å’Œåˆå§‹çŠ¶æ€æ›¿æ¢åï¼Œå¯ä»¥ç§°ä¹‹ä¸ºï¼šè¿ç§»åˆ°æ–°ç‰ˆæœ¬ã€‚")]),a._v(" "),s("p",[a._v("Flyway ä¸€æ—¦æ‰«æäº†æ–‡ä»¶ç³»ç»Ÿæˆ–åº”ç”¨ classpath ä¸‹çš„ migrationsï¼Œè¿™äº› migrations ä¼šæ£€æŸ¥ schema å†å²è¡¨ã€‚å¦‚æœå®ƒä»¬çš„ç‰ˆæœ¬å·ä½äºæˆ–ç­‰äºå½“å‰çš„ç‰ˆæœ¬ï¼Œå°†è¢«å¿½ç•¥ã€‚ä¿ç•™ä¸‹æ¥çš„ migrations æ˜¯ç­‰å¾…çš„ migrationsï¼Œæœ‰æ•ˆä½†æ²¡æœ‰åº”ç”¨ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-99a88fea7a31a070.png",alt:"img"}})]),a._v(" "),s("p",[a._v("migrations å°†æ ¹æ®ç‰ˆæœ¬å·æ’åºå¹¶æŒ‰åºæ‰§è¡Œã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://upload-images.jianshu.io/upload_images/3101171-b444fef6e5c13b71.png",alt:"img"}})]),a._v(" "),s("h2",{attrs:{id:"å¿«é€Ÿä¸Šæ‰‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¿«é€Ÿä¸Šæ‰‹"}},[a._v("#")]),a._v(" å¿«é€Ÿä¸Šæ‰‹")]),a._v(" "),s("p",[a._v("Flyway æœ‰ 4 ç§ä½¿ç”¨æ–¹å¼ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("å‘½ä»¤è¡Œ")]),a._v(" "),s("li",[a._v("JAVA API")]),a._v(" "),s("li",[a._v("Maven")]),a._v(" "),s("li",[a._v("Gradle")])]),a._v(" "),s("h3",{attrs:{id:"å‘½ä»¤è¡Œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤è¡Œ"}},[a._v("#")]),a._v(" å‘½ä»¤è¡Œ")]),a._v(" "),s("p",[a._v("é€‚ç”¨äºé Java ç”¨æˆ·ï¼Œæ— éœ€æ„å»ºã€‚")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" flyway migrate -url"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(". -user"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(". -password"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])])]),s("p",[a._v("ï¼ˆ1ï¼‰"),s("strong",[a._v("ä¸‹è½½è§£å‹")])]),a._v(" "),s("p",[a._v("è¿›å…¥"),s("a",{attrs:{href:"https://flywaydb.org/download/",target:"_blank",rel:"noopener noreferrer"}},[a._v("å®˜æ–¹ä¸‹è½½é¡µé¢"),s("OutboundLink")],1),a._v("ï¼Œé€‰æ‹©åˆé€‚ç‰ˆæœ¬ï¼Œä¸‹è½½å¹¶è§£å‹åˆ°æœ¬åœ°ã€‚")]),a._v(" "),s("p",[a._v("ï¼ˆ2ï¼‰"),s("strong",[a._v("é…ç½® flyway")])]),a._v(" "),s("p",[a._v("ç¼–è¾‘ "),s("code",[a._v("/conf/flyway.conf")]),a._v("ï¼š")]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("flyway.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:h2:file:./foobardb")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("flyway.user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("SA")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("flyway.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n")])])]),s("p",[a._v("ï¼ˆ3ï¼‰"),s("strong",[a._v("åˆ›å»ºç¬¬ä¸€ä¸ª migration")])]),a._v(" "),s("p",[a._v("åœ¨ "),s("code",[a._v("/sql")]),a._v(" ç›®å½•ä¸‹åˆ›å»º "),s("code",[a._v("V1__Create_person_table.sql")]),a._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    ID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    NAME "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("ï¼ˆ4ï¼‰"),s("strong",[a._v("è¿ç§»æ•°æ®åº“")])]),a._v(" "),s("p",[a._v("è¿è¡Œ Flyway æ¥è¿ç§»æ•°æ®åº“ï¼š")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("flyway-5.1."),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("4")]),a._v(">")]),a._v(" flyway migrate\n")])])]),s("p",[a._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Database: jdbc:h2:file:./foobardb (H2 1.4)\nSuccessfully validated 1 migration (execution time 00:00.008s)\nCreating Schema History table: "PUBLIC"."flyway_schema_history"\nCurrent version of schema "PUBLIC": << Empty Schema >>\nMigrating schema "PUBLIC" to version 1 - Create person table\nSuccessfully applied 1 migration to schema "PUBLIC" (execution time 00:00.033s)\n')])])]),s("p",[a._v("ï¼ˆ5ï¼‰"),s("strong",[a._v("æ·»åŠ ç¬¬äºŒä¸ª migration")])]),a._v(" "),s("p",[a._v("åœ¨ "),s("code",[a._v("/sql")]),a._v(" ç›®å½•ä¸‹åˆ›å»º "),s("code",[a._v("V2__Add_people.sql")]),a._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Axel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Mr. Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Ms. Bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("è¿è¡Œ Flyway")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("flyway-5.1."),s("span",{pre:!0,attrs:{class:"token operator"}},[s("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[a._v("4")]),a._v(">")]),a._v(" flyway migrate\n")])])]),s("p",[a._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Database: jdbc:h2:file:./foobardb (H2 1.4)\nSuccessfully validated 2 migrations (execution time 00:00.018s)\nCurrent version of schema "PUBLIC": 1\nMigrating schema "PUBLIC" to version 2 - Add people\nSuccessfully applied 1 migration to schema "PUBLIC" (execution time 00:00.016s)\n')])])]),s("h3",{attrs:{id:"java-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-api"}},[a._v("#")]),a._v(" JAVA API")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰"),s("strong",[a._v("å‡†å¤‡")])]),a._v(" "),s("ul",[s("li",[a._v("Java8+")]),a._v(" "),s("li",[a._v("Maven 3.x")])]),a._v(" "),s("p",[a._v("ï¼ˆ2ï¼‰"),s("strong",[a._v("æ·»åŠ ä¾èµ–")])]),a._v(" "),s("p",[a._v("åœ¨ "),s("code",[a._v("pom.xml")]),a._v(" ä¸­æ·»åŠ ä¾èµ–ï¼š")]),a._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("project")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("...")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.flywaydb"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("flyway-core"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("5.1.4"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.h2database"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("h2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("1.3.170"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    ...\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("project")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),s("p",[a._v("ï¼ˆ3ï¼‰"),s("strong",[a._v("é›†æˆ Flyway")])]),a._v(" "),s("p",[a._v("æ·»åŠ  "),s("code",[a._v("App.java")]),a._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token import"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("flywaydb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("core"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Flyway")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("App")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// Create the Flyway instance")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Flyway")]),a._v(" flyway "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Flyway")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// Point it to the database")]),a._v("\n        flyway"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setDataSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:h2:file:./target/foobar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sa"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// Start the migration")]),a._v("\n        flyway"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("migrate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("ï¼ˆ4ï¼‰"),s("strong",[a._v("åˆ›å»ºç¬¬ä¸€ä¸ª migration")])]),a._v(" "),s("p",[a._v("æ·»åŠ  "),s("code",[a._v("src/main/resources/db/migration/V1__Create_person_table.sql")]),a._v(" æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    ID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    NAME "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("ï¼ˆ5ï¼‰"),s("strong",[a._v("æ‰§è¡Œç¨‹åº")])]),a._v(" "),s("p",[a._v("æ‰§è¡Œ "),s("code",[a._v("App#main")]),a._v("ï¼š")]),a._v(" "),s("p",[a._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('INFO: Creating schema history table: "PUBLIC"."flyway_schema_history"\nINFO: Current version of schema "PUBLIC": << Empty Schema >>\nINFO: Migrating schema "PUBLIC" to version 1 - Create person table\nINFO: Successfully applied 1 migration to schema "PUBLIC" (execution time 00:00.062s).\n')])])]),s("p",[a._v("ï¼ˆ6ï¼‰"),s("strong",[a._v("æ·»åŠ ç¬¬äºŒä¸ª migration")])]),a._v(" "),s("p",[a._v("æ·»åŠ  src/main/resources/db/migration/V2__Add_people.sql æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Axel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Mr. Foo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" PERSON "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" NAME"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'Ms. Bar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("p",[a._v("è¿è¡Œæ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç»“æœï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('INFO: Current version of schema "PUBLIC": 1\nINFO: Migrating schema "PUBLIC" to version 2 - Add people\nINFO: Successfully applied 1 migration to schema "PUBLIC" (execution time 00:00.090s).\n')])])]),s("h3",{attrs:{id:"maven"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#maven"}},[a._v("#")]),a._v(" Maven")]),a._v(" "),s("p",[a._v("ä¸ Java API æ–¹å¼å¤§ä½“ç›¸åŒï¼ŒåŒºåˆ«åœ¨ "),s("strong",[a._v("é›†æˆ Flyway")]),a._v(" æ­¥éª¤ï¼š")]),a._v(" "),s("p",[a._v("Maven æ–¹å¼ä½¿ç”¨æ’ä»¶æ¥é›†æˆ Flywayï¼š")]),a._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("project")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("xmlns")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("..."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    ...\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("plugins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.flywaydb"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("flyway-maven-plugin"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("5.1.4"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("jdbc:h2:file:./target/foobar"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("sa"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.h2database"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("h2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("1.4.191"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependencies")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("plugins")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("build")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("project")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),s("p",[a._v("å› ä¸ºç”¨çš„æ˜¯æ’ä»¶ï¼Œæ‰€ä»¥æ‰§è¡Œæ–¹å¼ä¸å†æ˜¯è¿è¡Œ Java ç±»ï¼Œè€Œæ˜¯æ‰§è¡Œ maven æ’ä»¶ï¼š")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" mvn flyway:migrate\n")])])]),s("blockquote",[s("p",[a._v("ğŸ‘‰ å‚è€ƒï¼š"),s("a",{attrs:{href:"https://github.com/dunwu/Database/tree/master/codes/middleware/flyway",target:"_blank",rel:"noopener noreferrer"}},[a._v("ç¤ºä¾‹æºç "),s("OutboundLink")],1)])]),a._v(" "),s("h3",{attrs:{id:"gradle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gradle"}},[a._v("#")]),a._v(" Gradle")]),a._v(" "),s("p",[a._v("æœ¬äººä¸ç”¨ Gradleï¼Œç•¥ã€‚")]),a._v(" "),s("h2",{attrs:{id:"å…¥é—¨ç¯‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…¥é—¨ç¯‡"}},[a._v("#")]),a._v(" å…¥é—¨ç¯‡")]),a._v(" "),s("h3",{attrs:{id:"æ¦‚å¿µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚å¿µ"}},[a._v("#")]),a._v(" æ¦‚å¿µ")]),a._v(" "),s("h4",{attrs:{id:"migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#migrations"}},[a._v("#")]),a._v(" Migrations")]),a._v(" "),s("p",[a._v("åœ¨ Flyway ä¸­ï¼Œå¯¹äºæ•°æ®åº“çš„ä»»ä½•æ”¹å˜éƒ½ç§°ä¹‹ä¸º "),s("strong",[a._v("Migrations")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("Migrations å¯ä»¥åˆ†ä¸º Versioned migrations å’Œ Repeatable migrationsã€‚")]),a._v(" "),s("p",[a._v("Versioned migrations æœ‰ 2 ç§å½¢å¼ï¼šregular å’Œ undoã€‚")]),a._v(" "),s("p",[a._v("Versioned migrations å’Œ Repeatable migrations éƒ½å¯ä»¥ä½¿ç”¨ SQL æˆ– JAVA æ¥ç¼–å†™ã€‚")]),a._v(" "),s("h5",{attrs:{id:"versioned-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#versioned-migrations"}},[a._v("#")]),a._v(" Versioned migrations")]),a._v(" "),s("p",[a._v("ç”±ä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆversionï¼‰ã€ä¸€æ®µæè¿°ï¼ˆdescriptionï¼‰ã€ä¸€ä¸ªæ ¡éªŒï¼ˆchecksumï¼‰ç»„æˆã€‚ç‰ˆæœ¬å·å¿…é¡»æ˜¯æƒŸä¸€çš„ã€‚Versioned migrations åªèƒ½æŒ‰é¡ºåºæ‰§è¡Œä¸€æ¬¡ã€‚")]),a._v(" "),s("p",[a._v("ä¸€èˆ¬ç”¨äºï¼š")]),a._v(" "),s("ul",[s("li",[a._v("å¢åˆ æ”¹ tables/indexes/foreign keys/enums/UDTsã€‚")]),a._v(" "),s("li",[a._v("å¼•ç”¨æ•°æ®æ›´æ–°")]),a._v(" "),s("li",[a._v("ç”¨æˆ·æ•°æ®æ ¡æ­£")])]),a._v(" "),s("p",[a._v("Regular ç¤ºä¾‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" car "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n    id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NOT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PRIMARY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("KEY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    license_plate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VARCHAR")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NOT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    color "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VARCHAR")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NOT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" owner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ADD")]),a._v(" driver_license_id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VARCHAR")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" brand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VALUES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'DeLorean'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("h5",{attrs:{id:"undo-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#undo-migrations"}},[a._v("#")]),a._v(" Undo migrations")]),a._v(" "),s("blockquote",[s("p",[a._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒ")])]),a._v(" "),s("p",[a._v("Undo Versioned Migrations è´Ÿè´£æ’¤é”€ Regular Versioned migrations çš„å½±å“ã€‚")]),a._v(" "),s("p",[a._v("Undo ç¤ºä¾‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" brand "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'DeLorean'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ALTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" owner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" driver_license_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DROP")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" car"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("h5",{attrs:{id:"repeatable-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#repeatable-migrations"}},[a._v("#")]),a._v(" Repeatable migrations")]),a._v(" "),s("p",[a._v("ç”±ä¸€æ®µæè¿°ï¼ˆdescriptionï¼‰ã€ä¸€ä¸ªæ ¡éªŒï¼ˆchecksumï¼‰ç»„æˆã€‚Versioned migrations æ¯æ¬¡æ‰§è¡Œåï¼Œæ ¡éªŒï¼ˆchecksumï¼‰ä¼šæ›´æ–°ã€‚")]),a._v(" "),s("p",[a._v("Repeatable migrations ç”¨äºç®¡ç†å¯ä»¥é€šè¿‡ä¸€ä¸ªæ–‡ä»¶æ¥ç»´æŠ¤ç‰ˆæœ¬æ§åˆ¶çš„æ•°æ®åº“å¯¹è±¡ã€‚")]),a._v(" "),s("p",[a._v("ä¸€èˆ¬ç”¨äºï¼š")]),a._v(" "),s("ul",[s("li",[a._v("åˆ›å»ºï¼ˆé‡å»ºï¼‰views/procedures/functions/packages ç­‰ã€‚")]),a._v(" "),s("li",[a._v("å¤§é‡å¼•ç”¨æ•°æ®é‡æ–°æ’å…¥")])]),a._v(" "),s("p",[a._v("ç¤ºä¾‹ï¼š")]),a._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("OR")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPLACE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VIEW")]),a._v(" blue_cars "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AS")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" license_plate "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" cars "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" color"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'blue'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),s("h5",{attrs:{id:"åŸºäº-sql-çš„-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-sql-çš„-migrations"}},[a._v("#")]),a._v(" åŸºäº SQL çš„ migrations")]),a._v(" "),s("p",[a._v("migrations æœ€å¸¸ç”¨çš„ç¼–å†™å½¢å¼å°±æ˜¯ SQLã€‚")]),a._v(" "),s("p",[a._v("åŸºäº SQL çš„ migrations ä¸€èˆ¬ç”¨äºï¼š")]),a._v(" "),s("ul",[s("li",[a._v("DDL å˜æ›´ï¼ˆé’ˆå¯¹ TABLES,VIEWS,TRIGGERS,SEQUENCES ç­‰çš„ CREATE/ALTER/DROP æ“ä½œï¼‰")]),a._v(" "),s("li",[a._v("ç®€å•çš„å¼•ç”¨æ•°æ®å˜æ›´ï¼ˆå¼•ç”¨æ•°æ®è¡¨ä¸­çš„ CRUDï¼‰")]),a._v(" "),s("li",[a._v("ç®€å•çš„å¤§é‡æ•°æ®å˜æ›´ï¼ˆå¸¸è§„æ•°æ®è¡¨ä¸­çš„ CRUDï¼‰")])]),a._v(" "),s("p",[s("strong",[a._v("å‘½åè§„åˆ™")])]),a._v(" "),s("p",[a._v("ä¸ºäº†è¢« Flyway è‡ªåŠ¨è¯†åˆ«ï¼ŒSQL migrations çš„æ–‡ä»¶å‘½åå¿…é¡»éµå¾ªè§„å®šçš„æ¨¡å¼ï¼š")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/cs/database/flyway/sql-migrations.png",alt:"img"}})]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("Prefix")]),a._v(" - "),s("code",[a._v("V")]),a._v(" ä»£è¡¨ versioned migrations (å¯é…ç½®), "),s("code",[a._v("U")]),a._v(" ä»£è¡¨ undo migrations (å¯é…ç½®)ã€ "),s("code",[a._v("R")]),a._v(" ä»£è¡¨ repeatable migrations (å¯é…ç½®)")]),a._v(" "),s("li",[s("strong",[a._v("Version")]),a._v(" - ç‰ˆæœ¬å·é€šè¿‡"),s("code",[a._v(".")]),a._v("(ç‚¹)æˆ–"),s("code",[a._v("_")]),a._v("(ä¸‹åˆ’çº¿)åˆ†éš” (repeatable migrations ä¸éœ€è¦)")]),a._v(" "),s("li",[s("strong",[a._v("Separator")]),a._v(" - "),s("code",[a._v("__")]),a._v(" (ä¸¤ä¸ªä¸‹åˆ’çº¿) (å¯é…ç½®)")]),a._v(" "),s("li",[s("strong",[a._v("Description")]),a._v(" - ä¸‹åˆ’çº¿æˆ–ç©ºæ ¼åˆ†éš”çš„å•è¯")]),a._v(" "),s("li",[s("strong",[a._v("Suffix")]),a._v(" - "),s("code",[a._v(".sql")]),a._v(" (å¯é…ç½®)")])]),a._v(" "),s("h5",{attrs:{id:"åŸºäº-java-çš„-migrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-java-çš„-migrations"}},[a._v("#")]),a._v(" åŸºäº JAVA çš„ migrations")]),a._v(" "),s("p",[a._v("åŸºäº JAVA çš„ migrations é€‚ç”¨äºä½¿ç”¨ SQL ä¸å®¹æ˜“è¡¨è¾¾çš„åœºæ™¯ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("BLOB å’Œ CLOB å˜æ›´")]),a._v(" "),s("li",[a._v("å¤§é‡æ•°æ®çš„é«˜çº§å˜æ›´ï¼ˆé‡æ–°è®¡ç®—ã€é«˜çº§æ ¼å¼å˜æ›´ï¼‰")])]),a._v(" "),s("p",[s("strong",[a._v("å‘½åè§„åˆ™")])]),a._v(" "),s("p",[a._v("ä¸ºäº†è¢« Flyway è‡ªåŠ¨è¯†åˆ«ï¼ŒJAVA migrations çš„æ–‡ä»¶å‘½åå¿…é¡»éµå¾ªè§„å®šçš„æ¨¡å¼ï¼š")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/cs/database/flyway/java-migrations.png",alt:"img"}})]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("Prefix")]),a._v(" - "),s("code",[a._v("V")]),a._v(" ä»£è¡¨ versioned migrations (å¯é…ç½®), "),s("code",[a._v("U")]),a._v(" ä»£è¡¨ undo migrations (å¯é…ç½®)ã€ "),s("code",[a._v("R")]),a._v(" ä»£è¡¨ repeatable migrations (å¯é…ç½®)")]),a._v(" "),s("li",[s("strong",[a._v("Version")]),a._v(" - ç‰ˆæœ¬å·é€šè¿‡"),s("code",[a._v(".")]),a._v("(ç‚¹)æˆ–"),s("code",[a._v("_")]),a._v("(ä¸‹åˆ’çº¿)åˆ†éš” (repeatable migrations ä¸éœ€è¦)")]),a._v(" "),s("li",[s("strong",[a._v("Separator")]),a._v(" - "),s("code",[a._v("__")]),a._v(" (ä¸¤ä¸ªä¸‹åˆ’çº¿) (å¯é…ç½®)")]),a._v(" "),s("li",[s("strong",[a._v("Description")]),a._v(" - ä¸‹åˆ’çº¿æˆ–ç©ºæ ¼åˆ†éš”çš„å•è¯")])]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ‘‰ æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼šhttps://flywaydb.org/documentation/migrations")])]),a._v(" "),s("h4",{attrs:{id:"callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#callbacks"}},[a._v("#")]),a._v(" Callbacks")]),a._v(" "),s("blockquote",[s("p",[a._v("æ³¨ï¼šéƒ¨åˆ† events ä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),a._v(" "),s("p",[a._v("å°½ç®¡ Migrations å¯èƒ½å·²ç»æ»¡è¶³ç»å¤§éƒ¨åˆ†åœºæ™¯çš„éœ€è¦ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¸‹éœ€è¦ä½ ä¸€éåˆä¸€éçš„æ‰§è¡Œç›¸åŒçš„è¡Œä¸ºã€‚è¿™å¯èƒ½ä¼šé‡æ–°ç¼–è¯‘å­˜å‚¨è¿‡ç¨‹ï¼Œæ›´æ–°è§†å›¾ä»¥åŠè®¸å¤šå…¶ä»–ç±»å‹çš„å¼€é”€ã€‚")]),a._v(" "),s("p",[a._v("å› ä¸ºä»¥ä¸ŠåŸå› ï¼ŒFlyway æä¾›äº† Callbacksï¼Œç”¨äºåœ¨ Migrations ç”Ÿå‘½å‘¨æœŸä¸­æ·»åŠ é’©å­ã€‚")]),a._v(" "),s("p",[a._v("Callbacks å¯ä»¥ç”¨ SQL æˆ– JAVA æ¥å®ç°ã€‚")]),a._v(" "),s("h5",{attrs:{id:"sql-callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-callbacks"}},[a._v("#")]),a._v(" SQL Callbacks")]),a._v(" "),s("p",[a._v("SQL Callbacks çš„å‘½åè§„åˆ™ä¸ºï¼ševent å + SQL migrationã€‚")]),a._v(" "),s("p",[a._v("å¦‚ï¼š "),s("code",[a._v("beforeMigrate.sql")]),a._v(", "),s("code",[a._v("beforeEachMigrate.sql")]),a._v(", "),s("code",[a._v("afterEachMigrate.sql")]),a._v(" ç­‰ã€‚")]),a._v(" "),s("p",[a._v("SQL Callbacks ä¹Ÿå¯ä»¥åŒ…å«æè¿°ï¼ˆdescriptionï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒSQL Callbacks æ–‡ä»¶å = event å + åˆ†éš”ç¬¦ + æè¿° + åç¼€ã€‚ä¾‹ï¼š"),s("code",[a._v("beforeRepair__vacuum.sql")])]),a._v(" "),s("p",[a._v("å½“åŒä¸€ä¸ª event æœ‰å¤šä¸ª SQL callbacksï¼Œå°†æŒ‰ç…§å®ƒä»¬æè¿°ï¼ˆdescriptionï¼‰çš„é¡ºåºæ‰§è¡Œã€‚")]),a._v(" "),s("blockquote",[s("p",[s("strong",[a._v("æ³¨ï¼š")]),a._v(" Flyway ä¹Ÿæ”¯æŒä½ é…ç½®çš„ "),s("code",[a._v("sqlMigrationSuffixes")]),a._v("ã€‚")])]),a._v(" "),s("h5",{attrs:{id:"java-callbacks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-callbacks"}},[a._v("#")]),a._v(" JAVA Callbacks")]),a._v(" "),s("blockquote",[s("p",[a._v("å½“ SQL Callbacks ä¸å¤Ÿæ–¹ä¾¿æ—¶ï¼Œæ‰åº”è€ƒè™‘ JAVA Callbacksã€‚")])]),a._v(" "),s("p",[a._v("JAVA Callbacks æœ‰ 3 ç§å½¢å¼ï¼š")]),a._v(" "),s("ol",[s("li",[s("strong",[a._v("åŸºäº Java çš„ Migrations")]),a._v(" - å®ç° JdbcMigrationã€SpringJdbcMigrationã€MigrationInfoProviderã€MigrationChecksumProviderã€ConfigurationAwareã€FlywayConfiguration")]),a._v(" "),s("li",[s("strong",[a._v("åŸºäº Java çš„ Callbacks")]),a._v(" - å®ç° org.flywaydb.core.api.callback æ¥å£ã€‚")]),a._v(" "),s("li",[s("strong",[a._v("è‡ªå®šä¹‰ Migration resolvers å’Œ executors")]),a._v(" - å®ç° MigrationResolverã€MigrationExecutorã€ConfigurationAwareã€FlywayConfiguration æ¥å£ã€‚")])]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ‘‰ æ›´å¤šç»†èŠ‚è¯·å‚è€ƒï¼šhttps://flywaydb.org/documentation/callbacks")])]),a._v(" "),s("h4",{attrs:{id:"error-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-handlers"}},[a._v("#")]),a._v(" Error Handlers")]),a._v(" "),s("blockquote",[s("p",[a._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),a._v(" "),s("p",[a._v("ï¼ˆç•¥ï¼‰")]),a._v(" "),s("h4",{attrs:{id:"dry-runs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dry-runs"}},[a._v("#")]),a._v(" Dry Runs")]),a._v(" "),s("blockquote",[s("p",[a._v("æ³¨ï¼šä»…ä¸“ä¸šç‰ˆæ”¯æŒã€‚")])]),a._v(" "),s("p",[a._v("ï¼ˆç•¥ï¼‰")]),a._v(" "),s("h3",{attrs:{id:"å‘½ä»¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤"}},[a._v("#")]),a._v(" å‘½ä»¤")]),a._v(" "),s("p",[a._v("Flyway çš„åŠŸèƒ½ä¸»è¦å›´ç»•ç€ 7 ä¸ªåŸºæœ¬å‘½ä»¤ï¼š"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/migrate",target:"_blank",rel:"noopener noreferrer"}},[a._v("Migrate"),s("OutboundLink")],1),a._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/clean",target:"_blank",rel:"noopener noreferrer"}},[a._v("Clean"),s("OutboundLink")],1),a._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/info",target:"_blank",rel:"noopener noreferrer"}},[a._v("Info"),s("OutboundLink")],1),a._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/validate",target:"_blank",rel:"noopener noreferrer"}},[a._v("Validate"),s("OutboundLink")],1),a._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/undo",target:"_blank",rel:"noopener noreferrer"}},[a._v("Undo"),s("OutboundLink")],1),a._v("ã€"),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/baseline",target:"_blank",rel:"noopener noreferrer"}},[a._v("Baseline"),s("OutboundLink")],1),a._v(" å’Œ "),s("a",{attrs:{href:"https://flywaydb.org/documentation/command/repair",target:"_blank",rel:"noopener noreferrer"}},[a._v("Repair"),s("OutboundLink")],1),a._v("ã€‚")]),a._v(" "),s("p",[a._v("æ³¨ï¼šå„å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ç»†èŠ‚è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚")]),a._v(" "),s("h3",{attrs:{id:"æ”¯æŒçš„æ•°æ®åº“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ”¯æŒçš„æ•°æ®åº“"}},[a._v("#")]),a._v(" æ”¯æŒçš„æ•°æ®åº“")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/oracle",target:"_blank",rel:"noopener noreferrer"}},[a._v("Oracle"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sqlserver",target:"_blank",rel:"noopener noreferrer"}},[a._v("SQL Server"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/db2",target:"_blank",rel:"noopener noreferrer"}},[a._v("DB2"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/mysql",target:"_blank",rel:"noopener noreferrer"}},[a._v("MySQL"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/mariadb",target:"_blank",rel:"noopener noreferrer"}},[a._v("MariaDB"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/postgresql",target:"_blank",rel:"noopener noreferrer"}},[a._v("PostgreSQL"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/redshift",target:"_blank",rel:"noopener noreferrer"}},[a._v("Redshift"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/cockroachdb",target:"_blank",rel:"noopener noreferrer"}},[a._v("CockroachDB"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/saphana",target:"_blank",rel:"noopener noreferrer"}},[a._v("SAP HANA"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sybasease",target:"_blank",rel:"noopener noreferrer"}},[a._v("Sybase ASE"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/informix",target:"_blank",rel:"noopener noreferrer"}},[a._v("Informix"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/h2",target:"_blank",rel:"noopener noreferrer"}},[a._v("H2"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/hsqldb",target:"_blank",rel:"noopener noreferrer"}},[a._v("HSQLDB"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/derby",target:"_blank",rel:"noopener noreferrer"}},[a._v("Derby"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://flywaydb.org/documentation/database/sqlite",target:"_blank",rel:"noopener noreferrer"}},[a._v("SQLite"),s("OutboundLink")],1)])]),a._v(" "),s("h2",{attrs:{id:"èµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èµ„æ–™"}},[a._v("#")]),a._v(" èµ„æ–™")]),a._v(" "),s("p",[a._v("| "),s("a",{attrs:{href:"https://github.com/flyway/flyway",target:"_blank",rel:"noopener noreferrer"}},[a._v("Github"),s("OutboundLink")],1),a._v(" | "),s("a",{attrs:{href:"https://flywaydb.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("å®˜æ–¹æ–‡æ¡£"),s("OutboundLink")],1),a._v(" |")]),a._v(" "),s("h2",{attrs:{id:"ä¼ é€é—¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¼ é€é—¨"}},[a._v("#")]),a._v(" ğŸšª ä¼ é€é—¨")]),a._v(" "),s("p",[a._v("| "),s("a",{attrs:{href:"https://github.com/dunwu/blog",target:"_blank",rel:"noopener noreferrer"}},[a._v("æˆ‘çš„ Github åšå®¢"),s("OutboundLink")],1),a._v(" | "),s("a",{attrs:{href:"https://github.com/dunwu/db-tutorial",target:"_blank",rel:"noopener noreferrer"}},[a._v("db-tutorial é¦–é¡µ"),s("OutboundLink")],1),a._v(" |")])])}),[],!1,null,null,null);t.default=e.exports}}]);