<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Elasticsearch è¿ç»´ | DB-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/db-tutorial/img/favicon.ico">
    <meta name="description" content="â˜• db-tutorial æ˜¯ä¸€ä¸ªæ•°æ®åº“æ•™ç¨‹ã€‚">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/db-tutorial/assets/css/0.styles.36a3d7fb.css" as="style"><link rel="preload" href="/db-tutorial/assets/js/app.940dcc4d.js" as="script"><link rel="preload" href="/db-tutorial/assets/js/2.4e32ee2e.js" as="script"><link rel="preload" href="/db-tutorial/assets/js/67.038a8a89.js" as="script"><link rel="prefetch" href="/db-tutorial/assets/js/10.02c02386.js"><link rel="prefetch" href="/db-tutorial/assets/js/11.42a18bcf.js"><link rel="prefetch" href="/db-tutorial/assets/js/12.2b118160.js"><link rel="prefetch" href="/db-tutorial/assets/js/13.7814d084.js"><link rel="prefetch" href="/db-tutorial/assets/js/14.c08a0650.js"><link rel="prefetch" href="/db-tutorial/assets/js/15.e459c644.js"><link rel="prefetch" href="/db-tutorial/assets/js/16.4ee1eedd.js"><link rel="prefetch" href="/db-tutorial/assets/js/17.3bc0bf3e.js"><link rel="prefetch" href="/db-tutorial/assets/js/18.611b1264.js"><link rel="prefetch" href="/db-tutorial/assets/js/19.ba1a9989.js"><link rel="prefetch" href="/db-tutorial/assets/js/20.a55eed2e.js"><link rel="prefetch" href="/db-tutorial/assets/js/21.57330fd8.js"><link rel="prefetch" href="/db-tutorial/assets/js/22.0922cbfd.js"><link rel="prefetch" href="/db-tutorial/assets/js/23.13a05379.js"><link rel="prefetch" href="/db-tutorial/assets/js/24.7d43a075.js"><link rel="prefetch" href="/db-tutorial/assets/js/25.c2664c97.js"><link rel="prefetch" href="/db-tutorial/assets/js/26.18958123.js"><link rel="prefetch" href="/db-tutorial/assets/js/27.4e5f228c.js"><link rel="prefetch" href="/db-tutorial/assets/js/28.ff033a27.js"><link rel="prefetch" href="/db-tutorial/assets/js/29.b0a7b26f.js"><link rel="prefetch" href="/db-tutorial/assets/js/3.0ff5540c.js"><link rel="prefetch" href="/db-tutorial/assets/js/30.10572f0d.js"><link rel="prefetch" href="/db-tutorial/assets/js/31.75cb518d.js"><link rel="prefetch" href="/db-tutorial/assets/js/32.e3a9db0e.js"><link rel="prefetch" href="/db-tutorial/assets/js/33.5b72c19e.js"><link rel="prefetch" href="/db-tutorial/assets/js/34.424e5a82.js"><link rel="prefetch" href="/db-tutorial/assets/js/35.d9199101.js"><link rel="prefetch" href="/db-tutorial/assets/js/36.ad2c6744.js"><link rel="prefetch" href="/db-tutorial/assets/js/37.54458e3e.js"><link rel="prefetch" href="/db-tutorial/assets/js/38.0f76b68b.js"><link rel="prefetch" href="/db-tutorial/assets/js/39.8852ef4d.js"><link rel="prefetch" href="/db-tutorial/assets/js/4.2e9ed9f0.js"><link rel="prefetch" href="/db-tutorial/assets/js/40.41b2d3b5.js"><link rel="prefetch" href="/db-tutorial/assets/js/41.e6505511.js"><link rel="prefetch" href="/db-tutorial/assets/js/42.5f60dcaa.js"><link rel="prefetch" href="/db-tutorial/assets/js/43.a4cf9e44.js"><link rel="prefetch" href="/db-tutorial/assets/js/44.85352ba6.js"><link rel="prefetch" href="/db-tutorial/assets/js/45.2ab14b1f.js"><link rel="prefetch" href="/db-tutorial/assets/js/46.dbeea3df.js"><link rel="prefetch" href="/db-tutorial/assets/js/47.9990e130.js"><link rel="prefetch" href="/db-tutorial/assets/js/48.396dc47c.js"><link rel="prefetch" href="/db-tutorial/assets/js/49.669653b3.js"><link rel="prefetch" href="/db-tutorial/assets/js/5.c51a9698.js"><link rel="prefetch" href="/db-tutorial/assets/js/50.051126eb.js"><link rel="prefetch" href="/db-tutorial/assets/js/51.fba95844.js"><link rel="prefetch" href="/db-tutorial/assets/js/52.8fecc3be.js"><link rel="prefetch" href="/db-tutorial/assets/js/53.0500141f.js"><link rel="prefetch" href="/db-tutorial/assets/js/54.1ee7ed0e.js"><link rel="prefetch" href="/db-tutorial/assets/js/55.81de2ae5.js"><link rel="prefetch" href="/db-tutorial/assets/js/56.1e304dba.js"><link rel="prefetch" href="/db-tutorial/assets/js/57.344cf3d2.js"><link rel="prefetch" href="/db-tutorial/assets/js/58.be416770.js"><link rel="prefetch" href="/db-tutorial/assets/js/59.454997ef.js"><link rel="prefetch" href="/db-tutorial/assets/js/6.4476abbb.js"><link rel="prefetch" href="/db-tutorial/assets/js/60.6bcdcdd0.js"><link rel="prefetch" href="/db-tutorial/assets/js/61.69b76c5b.js"><link rel="prefetch" href="/db-tutorial/assets/js/62.3e9b0d05.js"><link rel="prefetch" href="/db-tutorial/assets/js/63.cea50d68.js"><link rel="prefetch" href="/db-tutorial/assets/js/64.dfc202b7.js"><link rel="prefetch" href="/db-tutorial/assets/js/65.dc95297f.js"><link rel="prefetch" href="/db-tutorial/assets/js/66.f971662e.js"><link rel="prefetch" href="/db-tutorial/assets/js/68.afd446d7.js"><link rel="prefetch" href="/db-tutorial/assets/js/69.5164d8c8.js"><link rel="prefetch" href="/db-tutorial/assets/js/7.4487a643.js"><link rel="prefetch" href="/db-tutorial/assets/js/70.1472a602.js"><link rel="prefetch" href="/db-tutorial/assets/js/71.3511b41c.js"><link rel="prefetch" href="/db-tutorial/assets/js/72.41f8e9cb.js"><link rel="prefetch" href="/db-tutorial/assets/js/73.fe9208d3.js"><link rel="prefetch" href="/db-tutorial/assets/js/74.a1f606bb.js"><link rel="prefetch" href="/db-tutorial/assets/js/75.0dce22cf.js"><link rel="prefetch" href="/db-tutorial/assets/js/76.f02d488e.js"><link rel="prefetch" href="/db-tutorial/assets/js/77.c113d954.js"><link rel="prefetch" href="/db-tutorial/assets/js/78.7750882b.js"><link rel="prefetch" href="/db-tutorial/assets/js/79.36a315ff.js"><link rel="prefetch" href="/db-tutorial/assets/js/8.647c82b0.js"><link rel="prefetch" href="/db-tutorial/assets/js/80.ac2eb2f3.js"><link rel="prefetch" href="/db-tutorial/assets/js/9.f6be5cfa.js">
    <link rel="stylesheet" href="/db-tutorial/assets/css/0.styles.36a3d7fb.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/db-tutorial/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo.png" alt="DB-TUTORIAL" class="logo"> <span class="site-name can-hide">DB-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/db-tutorial/01.æ•°æ®åº“ç»¼åˆ/" class="nav-link">æ•°æ®åº“ç»¼åˆ</a></div><div class="nav-item"><a href="/db-tutorial/02.æ•°æ®åº“ä¸­é—´ä»¶/" class="nav-link">æ•°æ®åº“ä¸­é—´ä»¶</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…³ç³»å‹æ•°æ®åº“" class="dropdown-title"><a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/" class="link-title">å…³ç³»å‹æ•°æ®åº“</a> <span class="title" style="display:none;">å…³ç³»å‹æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/01.ç»¼åˆ/" class="nav-link">ç»¼åˆ</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/02.Mysql/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/99.å…¶ä»–/" class="nav-link">å…¶ä»–</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ–‡æ¡£æ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">æ–‡æ¡£æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/04.æ–‡æ¡£æ•°æ®åº“/01.MongoDB/" class="nav-link">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="KVæ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">KVæ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/05.KVæ•°æ®åº“/01.Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœç´¢å¼•æ“æ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">æœç´¢å¼•æ“æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/07.æœç´¢å¼•æ“æ•°æ®åº“/01.Elasticsearch/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/07.æœç´¢å¼•æ“æ•°æ®åº“/02.Elastic/" class="nav-link">ElasticæŠ€æœ¯æ ˆ</a></li></ul></div></div> <a href="https://github.com/dunwu/db-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/db-tutorial/01.æ•°æ®åº“ç»¼åˆ/" class="nav-link">æ•°æ®åº“ç»¼åˆ</a></div><div class="nav-item"><a href="/db-tutorial/02.æ•°æ®åº“ä¸­é—´ä»¶/" class="nav-link">æ•°æ®åº“ä¸­é—´ä»¶</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…³ç³»å‹æ•°æ®åº“" class="dropdown-title"><a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/" class="link-title">å…³ç³»å‹æ•°æ®åº“</a> <span class="title" style="display:none;">å…³ç³»å‹æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/01.ç»¼åˆ/" class="nav-link">ç»¼åˆ</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/02.Mysql/" class="nav-link">Mysql</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/03.å…³ç³»å‹æ•°æ®åº“/99.å…¶ä»–/" class="nav-link">å…¶ä»–</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ–‡æ¡£æ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">æ–‡æ¡£æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/04.æ–‡æ¡£æ•°æ®åº“/01.MongoDB/" class="nav-link">MongoDB</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="KVæ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">KVæ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/05.KVæ•°æ®åº“/01.Redis/" class="nav-link">Redis</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœç´¢å¼•æ“æ•°æ®åº“" class="dropdown-title"><!----> <span class="title" style="display:;">æœç´¢å¼•æ“æ•°æ®åº“</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/db-tutorial/07.æœç´¢å¼•æ“æ•°æ®åº“/01.Elasticsearch/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/db-tutorial/07.æœç´¢å¼•æ“æ•°æ®åº“/02.Elastic/" class="nav-link">ElasticæŠ€æœ¯æ ˆ</a></li></ul></div></div> <a href="https://github.com/dunwu/db-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Elasticsearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/db-tutorial/pages/1f9edc/" class="sidebar-link">Elasticsearch é¢è¯•æ€»ç»“</a></li><li><a href="/db-tutorial/pages/37b739/" class="sidebar-link">Elasticsearch å¿«é€Ÿå…¥é—¨</a></li><li><a href="/db-tutorial/pages/6f7391/" class="sidebar-link">Elasticsearch ç®€ä»‹</a></li><li><a href="/db-tutorial/pages/5291b4/" class="sidebar-link">Elasticsearch ç´¢å¼•</a></li><li><a href="/db-tutorial/pages/478bb5/" class="sidebar-link">Elasticsearch æŸ¥è¯¢</a></li><li><a href="/db-tutorial/pages/4ae35a/" class="sidebar-link">Elasticsearch é«˜äº®æœç´¢åŠæ˜¾ç¤º</a></li><li><a href="/db-tutorial/pages/44ca8e/" class="sidebar-link">Elasticsearch æ’åº</a></li><li><a href="/db-tutorial/pages/93fa2a/" class="sidebar-link">Elasticsearch èšåˆ</a></li><li><a href="/db-tutorial/pages/c04143/" class="sidebar-link">Elasticsearch åˆ†æå™¨</a></li><li><a href="/db-tutorial/pages/dc6b0f/" class="sidebar-link">Elasticsearch æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="/db-tutorial/pages/1edd27/" class="sidebar-link">Elasticsearch Rest API</a></li><li><a href="/db-tutorial/pages/baf137/" class="sidebar-link">ElasticSearch Java API ä¹‹ High Level REST Client</a></li><li><a href="/db-tutorial/pages/d894ac/" class="sidebar-link">Elasticsearch é›†ç¾¤å’Œåˆ†ç‰‡</a></li><li><a href="/db-tutorial/pages/805d11/" aria-current="page" class="active sidebar-link">Elasticsearch è¿ç»´</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/db-tutorial/pages/805d11/#_1-elasticsearch-å®‰è£…" class="sidebar-link">1. Elasticsearch å®‰è£…</a></li><li class="sidebar-sub-header level2"><a href="/db-tutorial/pages/805d11/#_2-elasticsearch-é›†ç¾¤è§„åˆ’" class="sidebar-link">2. Elasticsearch é›†ç¾¤è§„åˆ’</a></li><li class="sidebar-sub-header level2"><a href="/db-tutorial/pages/805d11/#_3-elasticsearch-é…ç½®" class="sidebar-link">3. Elasticsearch é…ç½®</a></li><li class="sidebar-sub-header level2"><a href="/db-tutorial/pages/805d11/#_4-elasticsearch-faq" class="sidebar-link">4. Elasticsearch FAQ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/db-tutorial/pages/805d11/#_4-1-elasticsearch-ä¸å…è®¸ä»¥-root-æƒé™æ¥è¿è¡Œ" class="sidebar-link">4.1. elasticsearch ä¸å…è®¸ä»¥ root æƒé™æ¥è¿è¡Œ</a></li><li class="sidebar-sub-header level3"><a href="/db-tutorial/pages/805d11/#_4-2-vm-max-map-count-ä¸ä½äº-262144" class="sidebar-link">4.2. vm.maxmapcount ä¸ä½äº 262144</a></li><li class="sidebar-sub-header level3"><a href="/db-tutorial/pages/805d11/#_4-3-nofile-ä¸ä½äº-65536" class="sidebar-link">4.3. nofile ä¸ä½äº 65536</a></li><li class="sidebar-sub-header level3"><a href="/db-tutorial/pages/805d11/#_4-4-nproc-ä¸ä½äº-2048" class="sidebar-link">4.4. nproc ä¸ä½äº 2048</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/db-tutorial/pages/805d11/#_5-å‚è€ƒèµ„æ–™" class="sidebar-link">5. å‚è€ƒèµ„æ–™</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Elastic</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/db-tutorial/pages/d5bdd0/" class="sidebar-link">Elastic å¿«é€Ÿå…¥é—¨</a></li><li><a href="/db-tutorial/pages/3efdd8/" class="sidebar-link">Elastic æŠ€æœ¯æ ˆä¹‹ Filebeat</a></li><li><a href="/db-tutorial/pages/43db0b/" class="sidebar-link">Filebeat è¿ç»´</a></li><li><a href="/db-tutorial/pages/507fcc/" class="sidebar-link">Elastic æŠ€æœ¯æ ˆä¹‹ Kibana</a></li><li><a href="/db-tutorial/pages/8d96f6/" class="sidebar-link">Kibana è¿ç»´</a></li><li><a href="/db-tutorial/pages/0da19c/" class="sidebar-link">Elastic æŠ€æœ¯æ ˆä¹‹ Logstash</a></li><li><a href="/db-tutorial/pages/ec3c6f/" class="sidebar-link">Logstash è¿ç»´</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/db-tutorial/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/db-tutorial/categories/?category=%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E6%95%B0%E6%8D%AE%E5%BA%93" title="åˆ†ç±»" data-v-1baff76c>æœç´¢å¼•æ“æ•°æ®åº“</a></li><li data-v-1baff76c><a href="/db-tutorial/categories/?category=Elasticsearch" title="åˆ†ç±»" data-v-1baff76c>Elasticsearch</a></li></ul> <div class="info" data-v-1baff76c><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/dunwu" target="_blank" title="ä½œè€…" class="beLink" data-v-1baff76c>dunwu</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2020-06-16</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Elasticsearch è¿ç»´<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="elasticsearch-è¿ç»´"><a href="#elasticsearch-è¿ç»´" class="header-anchor">#</a> Elasticsearch è¿ç»´</h1> <blockquote><p><a href="https://github.com/elastic/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œèƒ½å¤Ÿè§£å†³ä¸æ–­æ¶Œç°å‡ºçš„å„ç§ç”¨ä¾‹ã€‚ ä½œä¸º Elastic Stack çš„æ ¸å¿ƒï¼Œå®ƒé›†ä¸­å­˜å‚¨æ‚¨çš„æ•°æ®ï¼Œå¸®åŠ©æ‚¨å‘ç°æ„æ–™ä¹‹ä¸­ä»¥åŠæ„æ–™ä¹‹å¤–çš„æƒ…å†µã€‚</p></blockquote> <h2 id="_1-elasticsearch-å®‰è£…"><a href="#_1-elasticsearch-å®‰è£…" class="header-anchor">#</a> 1. Elasticsearch å®‰è£…</h2> <blockquote><p><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch å®˜æ–¹ä¸‹è½½å®‰è£…è¯´æ˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>ï¼ˆ1ï¼‰ä¸‹è½½è§£å‹</p> <p>è®¿é—® <a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">å®˜æ–¹ä¸‹è½½åœ°å€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ï¼Œé€‰æ‹©éœ€è¦çš„ç‰ˆæœ¬ï¼Œä¸‹è½½è§£å‹åˆ°æœ¬åœ°ã€‚</p> <p>ï¼ˆ2ï¼‰è¿è¡Œ</p> <p>è¿è¡Œ <code>bin/elasticsearch</code> (Windows ç³»ç»Ÿä¸Šè¿è¡Œ <code>bin\elasticsearch.bat</code> )</p> <p>ï¼ˆ3ï¼‰è®¿é—®</p> <p>æ‰§è¡Œ <code>curl http://localhost:9200/</code> æµ‹è¯•æœåŠ¡æ˜¯å¦å¯åŠ¨</p> <h2 id="_2-elasticsearch-é›†ç¾¤è§„åˆ’"><a href="#_2-elasticsearch-é›†ç¾¤è§„åˆ’" class="header-anchor">#</a> 2. Elasticsearch é›†ç¾¤è§„åˆ’</h2> <p>ElasticSearch é›†ç¾¤éœ€è¦æ ¹æ®ä¸šåŠ¡å®é™…æƒ…å†µå»åˆç†è§„åˆ’ã€‚</p> <p>éœ€è¦è€ƒè™‘çš„é—®é¢˜ç‚¹ï¼š</p> <ul><li>é›†ç¾¤éƒ¨ç½²å‡ ä¸ªèŠ‚ç‚¹ï¼Ÿ</li> <li>æœ‰å¤šå°‘ä¸ªç´¢å¼•ï¼Ÿ</li> <li>æ¯ä¸ªç´¢å¼•æœ‰å¤šå¤§æ•°æ®é‡ï¼Ÿ</li> <li>æ¯ä¸ªç´¢å¼•æœ‰å¤šå°‘ä¸ªåˆ†ç‰‡ï¼Ÿ</li></ul> <p>ä¸€ä¸ªå‚è€ƒè§„åˆ’ï¼š</p> <ul><li>3 å°æœºå™¨ï¼Œæ¯å°æœºå™¨æ˜¯ 6 æ ¸ 64G çš„ã€‚</li> <li>æˆ‘ä»¬ es é›†ç¾¤çš„æ—¥å¢é‡æ•°æ®å¤§æ¦‚æ˜¯ 2000 ä¸‡æ¡ï¼Œæ¯å¤©æ—¥å¢é‡æ•°æ®å¤§æ¦‚æ˜¯ 500MBï¼Œæ¯æœˆå¢é‡æ•°æ®å¤§æ¦‚æ˜¯ 6 äº¿ï¼Œ15Gã€‚ç›®å‰ç³»ç»Ÿå·²ç»è¿è¡Œäº†å‡ ä¸ªæœˆï¼Œç°åœ¨ es é›†ç¾¤é‡Œæ•°æ®æ€»é‡å¤§æ¦‚æ˜¯ 100G å·¦å³ã€‚</li> <li>ç›®å‰çº¿ä¸Šæœ‰ 5 ä¸ªç´¢å¼•ï¼ˆè¿™ä¸ªç»“åˆä½ ä»¬è‡ªå·±ä¸šåŠ¡æ¥ï¼Œçœ‹çœ‹è‡ªå·±æœ‰å“ªäº›æ•°æ®å¯ä»¥æ”¾ es çš„ï¼‰ï¼Œæ¯ä¸ªç´¢å¼•çš„æ•°æ®é‡å¤§æ¦‚æ˜¯ 20Gï¼Œæ‰€ä»¥è¿™ä¸ªæ•°æ®é‡ä¹‹å†…ï¼Œæˆ‘ä»¬æ¯ä¸ªç´¢å¼•åˆ†é…çš„æ˜¯ 8 ä¸ª shardï¼Œæ¯”é»˜è®¤çš„ 5 ä¸ª shard å¤šäº† 3 ä¸ª shardã€‚</li></ul> <h2 id="_3-elasticsearch-é…ç½®"><a href="#_3-elasticsearch-é…ç½®" class="header-anchor">#</a> 3. Elasticsearch é…ç½®</h2> <p>ES çš„é»˜è®¤é…ç½®æ–‡ä»¶ä¸º <code>config/elasticsearch.yml</code></p> <p>åŸºæœ¬é…ç½®è¯´æ˜å¦‚ä¸‹ï¼š</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> elasticsearch
<span class="token comment">#é…ç½®esçš„é›†ç¾¤åç§°ï¼Œé»˜è®¤æ˜¯elasticsearchï¼Œesä¼šè‡ªåŠ¨å‘ç°åœ¨åŒä¸€ç½‘æ®µä¸‹çš„esï¼Œå¦‚æœåœ¨åŒä¸€ç½‘æ®µä¸‹æœ‰å¤šä¸ªé›†ç¾¤ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªå±æ€§æ¥åŒºåˆ†ä¸åŒçš„é›†ç¾¤ã€‚</span>
<span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">'Franz Kafka'</span>
<span class="token comment">#èŠ‚ç‚¹åï¼Œé»˜è®¤éšæœºæŒ‡å®šä¸€ä¸ªnameåˆ—è¡¨ä¸­åå­—ï¼Œè¯¥åˆ—è¡¨åœ¨esçš„jaråŒ…ä¸­configæ–‡ä»¶å¤¹é‡Œname.txtæ–‡ä»¶ä¸­ï¼Œå…¶ä¸­æœ‰å¾ˆå¤šä½œè€…æ·»åŠ çš„æœ‰è¶£åå­—ã€‚</span>
<span class="token key atrule">node.master</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#æŒ‡å®šè¯¥èŠ‚ç‚¹æ˜¯å¦æœ‰èµ„æ ¼è¢«é€‰ä¸¾æˆä¸ºnodeï¼Œé»˜è®¤æ˜¯trueï¼Œesæ˜¯é»˜è®¤é›†ç¾¤ä¸­çš„ç¬¬ä¸€å°æœºå™¨ä¸ºmasterï¼Œå¦‚æœè¿™å°æœºæŒ‚äº†å°±ä¼šé‡æ–°é€‰ä¸¾masterã€‚</span>
<span class="token key atrule">node.data</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#æŒ‡å®šè¯¥èŠ‚ç‚¹æ˜¯å¦å­˜å‚¨ç´¢å¼•æ•°æ®ï¼Œé»˜è®¤ä¸ºtrueã€‚</span>
<span class="token key atrule">index.number_of_shards</span><span class="token punctuation">:</span> <span class="token number">5</span>
<span class="token comment">#è®¾ç½®é»˜è®¤ç´¢å¼•åˆ†ç‰‡ä¸ªæ•°ï¼Œé»˜è®¤ä¸º5ç‰‡ã€‚</span>
<span class="token key atrule">index.number_of_replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token comment">#è®¾ç½®é»˜è®¤ç´¢å¼•å‰¯æœ¬ä¸ªæ•°ï¼Œé»˜è®¤ä¸º1ä¸ªå‰¯æœ¬ã€‚</span>
<span class="token key atrule">path.conf</span><span class="token punctuation">:</span> /path/to/conf
<span class="token comment">#è®¾ç½®é…ç½®æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯esæ ¹ç›®å½•ä¸‹çš„configæ–‡ä»¶å¤¹ã€‚</span>
<span class="token key atrule">path.data</span><span class="token punctuation">:</span> /path/to/data
<span class="token comment">#è®¾ç½®ç´¢å¼•æ•°æ®çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯esæ ¹ç›®å½•ä¸‹çš„dataæ–‡ä»¶å¤¹ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªå­˜å‚¨è·¯å¾„ï¼Œç”¨é€—å·éš”å¼€ï¼Œä¾‹ï¼š</span>
<span class="token comment">#path.data: /path/to/data1,/path/to/data2</span>
<span class="token key atrule">path.work</span><span class="token punctuation">:</span> /path/to/work
<span class="token comment">#è®¾ç½®ä¸´æ—¶æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯esæ ¹ç›®å½•ä¸‹çš„workæ–‡ä»¶å¤¹ã€‚</span>
<span class="token key atrule">path.logs</span><span class="token punctuation">:</span> /path/to/logs
<span class="token comment">#è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯esæ ¹ç›®å½•ä¸‹çš„logsæ–‡ä»¶å¤¹</span>
<span class="token key atrule">path.plugins</span><span class="token punctuation">:</span> /path/to/plugins
<span class="token comment">#è®¾ç½®æ’ä»¶çš„å­˜æ”¾è·¯å¾„ï¼Œé»˜è®¤æ˜¯esæ ¹ç›®å½•ä¸‹çš„pluginsæ–‡ä»¶å¤¹</span>
<span class="token key atrule">bootstrap.mlockall</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#è®¾ç½®ä¸ºtrueæ¥é”ä½å†…å­˜ã€‚å› ä¸ºå½“jvmå¼€å§‹swappingæ—¶esçš„æ•ˆç‡ä¼šé™ä½ï¼Œæ‰€ä»¥è¦ä¿è¯å®ƒä¸swapï¼Œå¯ä»¥æŠŠ#ES_MIN_MEMå’ŒES_MAX_MEMä¸¤ä¸ªç¯å¢ƒå˜é‡è®¾ç½®æˆåŒä¸€ä¸ªå€¼ï¼Œå¹¶ä¸”ä¿è¯æœºå™¨æœ‰è¶³å¤Ÿçš„å†…å­˜åˆ†é…ç»™esã€‚åŒæ—¶ä¹Ÿè¦#å…è®¸elasticsearchçš„è¿›ç¨‹å¯ä»¥é”ä½å†…å­˜ï¼Œlinuxä¸‹å¯ä»¥é€šè¿‡`ulimit -l unlimited`å‘½ä»¤ã€‚</span>
<span class="token key atrule">network.bind_host</span><span class="token punctuation">:</span> 192.168.0.1
<span class="token comment">#è®¾ç½®ç»‘å®šçš„ipåœ°å€ï¼Œå¯ä»¥æ˜¯ipv4æˆ–ipv6çš„ï¼Œé»˜è®¤ä¸º0.0.0.0ã€‚</span>
<span class="token key atrule">network.publish_host</span><span class="token punctuation">:</span> 192.168.0.1
<span class="token comment">#è®¾ç½®å…¶å®ƒèŠ‚ç‚¹å’Œè¯¥èŠ‚ç‚¹äº¤äº’çš„ipåœ°å€ï¼Œå¦‚æœä¸è®¾ç½®å®ƒä¼šè‡ªåŠ¨åˆ¤æ–­ï¼Œå€¼å¿…é¡»æ˜¯ä¸ªçœŸå®çš„ipåœ°å€ã€‚</span>
<span class="token key atrule">network.host</span><span class="token punctuation">:</span> 192.168.0.1
<span class="token comment">#è¿™ä¸ªå‚æ•°æ˜¯ç”¨æ¥åŒæ—¶è®¾ç½®bind_hostå’Œpublish_hostä¸Šé¢ä¸¤ä¸ªå‚æ•°ã€‚</span>
<span class="token key atrule">transport.tcp.port</span><span class="token punctuation">:</span> <span class="token number">9300</span>
<span class="token comment">#è®¾ç½®èŠ‚ç‚¹é—´äº¤äº’çš„tcpç«¯å£ï¼Œé»˜è®¤æ˜¯9300ã€‚</span>
<span class="token key atrule">transport.tcp.compress</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#è®¾ç½®æ˜¯å¦å‹ç¼©tcpä¼ è¾“æ—¶çš„æ•°æ®ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¸å‹ç¼©ã€‚</span>
<span class="token key atrule">http.port</span><span class="token punctuation">:</span> <span class="token number">9200</span>
<span class="token comment">#è®¾ç½®å¯¹å¤–æœåŠ¡çš„httpç«¯å£ï¼Œé»˜è®¤ä¸º9200ã€‚</span>
<span class="token key atrule">http.max_content_length</span><span class="token punctuation">:</span> 100mb
<span class="token comment">#è®¾ç½®å†…å®¹çš„æœ€å¤§å®¹é‡ï¼Œé»˜è®¤100mb</span>
<span class="token key atrule">http.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token comment">#æ˜¯å¦ä½¿ç”¨httpåè®®å¯¹å¤–æä¾›æœåŠ¡ï¼Œé»˜è®¤ä¸ºtrueï¼Œå¼€å¯ã€‚</span>
<span class="token key atrule">gateway.type</span><span class="token punctuation">:</span> local
<span class="token comment">#gatewayçš„ç±»å‹ï¼Œé»˜è®¤ä¸ºlocalå³ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥è®¾ç½®ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œhadoopçš„#HDFSï¼Œå’Œamazonçš„s3æœåŠ¡å™¨ï¼Œå…¶å®ƒæ–‡ä»¶ç³»ç»Ÿçš„è®¾ç½®æ–¹æ³•ä¸‹æ¬¡å†è¯¦ç»†è¯´ã€‚</span>
<span class="token key atrule">gateway.recover_after_nodes</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token comment">#è®¾ç½®é›†ç¾¤ä¸­Nä¸ªèŠ‚ç‚¹å¯åŠ¨æ—¶è¿›è¡Œæ•°æ®æ¢å¤ï¼Œé»˜è®¤ä¸º1ã€‚</span>
<span class="token key atrule">gateway.recover_after_time</span><span class="token punctuation">:</span> 5m
<span class="token comment">#è®¾ç½®åˆå§‹åŒ–æ•°æ®æ¢å¤è¿›ç¨‹çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤æ˜¯5åˆ†é’Ÿã€‚</span>
<span class="token key atrule">gateway.expected_nodes</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token comment">#è®¾ç½®è¿™ä¸ªé›†ç¾¤ä¸­èŠ‚ç‚¹çš„æ•°é‡ï¼Œé»˜è®¤ä¸º2ï¼Œä¸€æ—¦è¿™Nä¸ªèŠ‚ç‚¹å¯åŠ¨ï¼Œå°±ä¼šç«‹å³è¿›è¡Œæ•°æ®æ¢å¤ã€‚</span>
<span class="token key atrule">cluster.routing.allocation.node_initial_primaries_recoveries</span><span class="token punctuation">:</span> <span class="token number">4</span>
<span class="token comment">#åˆå§‹åŒ–æ•°æ®æ¢å¤æ—¶ï¼Œå¹¶å‘æ¢å¤çº¿ç¨‹çš„ä¸ªæ•°ï¼Œé»˜è®¤ä¸º4ã€‚</span>
<span class="token key atrule">cluster.routing.allocation.node_concurrent_recoveries</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token comment">#æ·»åŠ åˆ é™¤èŠ‚ç‚¹æˆ–è´Ÿè½½å‡è¡¡æ—¶å¹¶å‘æ¢å¤çº¿ç¨‹çš„ä¸ªæ•°ï¼Œé»˜è®¤ä¸º4ã€‚</span>
<span class="token key atrule">indices.recovery.max_size_per_sec</span><span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token comment">#è®¾ç½®æ•°æ®æ¢å¤æ—¶é™åˆ¶çš„å¸¦å®½ï¼Œå¦‚å…¥100mbï¼Œé»˜è®¤ä¸º0ï¼Œå³æ— é™åˆ¶ã€‚</span>
<span class="token key atrule">indices.recovery.concurrent_streams</span><span class="token punctuation">:</span> <span class="token number">5</span>
<span class="token comment">#è®¾ç½®è¿™ä¸ªå‚æ•°æ¥é™åˆ¶ä»å…¶å®ƒåˆ†ç‰‡æ¢å¤æ•°æ®æ—¶æœ€å¤§åŒæ—¶æ‰“å¼€å¹¶å‘æµçš„ä¸ªæ•°ï¼Œé»˜è®¤ä¸º5ã€‚</span>
<span class="token key atrule">discovery.zen.minimum_master_nodes</span><span class="token punctuation">:</span> <span class="token number">1</span>
<span class="token comment">#è®¾ç½®è¿™ä¸ªå‚æ•°æ¥ä¿è¯é›†ç¾¤ä¸­çš„èŠ‚ç‚¹å¯ä»¥çŸ¥é“å…¶å®ƒNä¸ªæœ‰masterèµ„æ ¼çš„èŠ‚ç‚¹ã€‚é»˜è®¤ä¸º1ï¼Œå¯¹äºå¤§çš„é›†ç¾¤æ¥è¯´ï¼Œå¯ä»¥è®¾ç½®å¤§ä¸€ç‚¹çš„å€¼ï¼ˆ2-4ï¼‰</span>
<span class="token key atrule">discovery.zen.ping.timeout</span><span class="token punctuation">:</span> 3s
<span class="token comment">#è®¾ç½®é›†ç¾¤ä¸­è‡ªåŠ¨å‘ç°å…¶å®ƒèŠ‚ç‚¹æ—¶pingè¿æ¥è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º3ç§’ï¼Œå¯¹äºæ¯”è¾ƒå·®çš„ç½‘ç»œç¯å¢ƒå¯ä»¥é«˜ç‚¹çš„å€¼æ¥é˜²æ­¢è‡ªåŠ¨å‘ç°æ—¶å‡ºé”™ã€‚</span>
<span class="token key atrule">discovery.zen.ping.multicast.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token comment">#è®¾ç½®æ˜¯å¦æ‰“å¼€å¤šæ’­å‘ç°èŠ‚ç‚¹ï¼Œé»˜è®¤æ˜¯trueã€‚</span>
<span class="token key atrule">discovery.zen.ping.unicast.hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'host1'</span><span class="token punctuation">,</span> <span class="token string">'host2:port'</span><span class="token punctuation">,</span> <span class="token string">'host3[portX-portY]'</span><span class="token punctuation">]</span>
<span class="token comment">#è®¾ç½®é›†ç¾¤ä¸­masterèŠ‚ç‚¹çš„åˆå§‹åˆ—è¡¨ï¼Œå¯ä»¥é€šè¿‡è¿™äº›èŠ‚ç‚¹æ¥è‡ªåŠ¨å‘ç°æ–°åŠ å…¥é›†ç¾¤çš„èŠ‚ç‚¹ã€‚</span>
</code></pre></div><h2 id="_4-elasticsearch-faq"><a href="#_4-elasticsearch-faq" class="header-anchor">#</a> 4. Elasticsearch FAQ</h2> <h3 id="_4-1-elasticsearch-ä¸å…è®¸ä»¥-root-æƒé™æ¥è¿è¡Œ"><a href="#_4-1-elasticsearch-ä¸å…è®¸ä»¥-root-æƒé™æ¥è¿è¡Œ" class="header-anchor">#</a> 4.1. elasticsearch ä¸å…è®¸ä»¥ root æƒé™æ¥è¿è¡Œ</h3> <p>**é—®é¢˜ï¼š**åœ¨ Linux ç¯å¢ƒä¸­ï¼Œelasticsearch ä¸å…è®¸ä»¥ root æƒé™æ¥è¿è¡Œã€‚</p> <p>å¦‚æœä»¥ root èº«ä»½è¿è¡Œ elasticsearchï¼Œä¼šæç¤ºè¿™æ ·çš„é”™è¯¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>can not run elasticsearch as root
</code></pre></div><p>**è§£å†³æ–¹æ³•ï¼š**ä½¿ç”¨é root æƒé™è´¦å·è¿è¡Œ elasticsearch</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ›å»ºç”¨æˆ·ç»„</span>
<span class="token function">groupadd</span> elk
<span class="token comment"># åˆ›å»ºæ–°ç”¨æˆ·ï¼Œ-g elk è®¾ç½®å…¶ç”¨æˆ·ç»„ä¸º elkï¼Œ-p elk è®¾ç½®å…¶å¯†ç ä¸º elk</span>
<span class="token function">useradd</span> elk -g elk -p elk
<span class="token comment"># æ›´æ”¹ /opt æ–‡ä»¶å¤¹åŠå†…éƒ¨æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·åŠç»„ä¸º elk:elk</span>
<span class="token function">chown</span> -R elk:elk /opt <span class="token comment"># å‡è®¾ä½ çš„ elasticsearch å®‰è£…åœ¨ opt ç›®å½•ä¸‹</span>
<span class="token comment"># åˆ‡æ¢è´¦å·</span>
<span class="token function">su</span> elk
</code></pre></div><h3 id="_4-2-vm-max-map-count-ä¸ä½äº-262144"><a href="#_4-2-vm-max-map-count-ä¸ä½äº-262144" class="header-anchor">#</a> 4.2. vm.max_map_count ä¸ä½äº 262144</h3> <p><strong>é—®é¢˜ï¼š</strong><code>vm.max_map_count</code> è¡¨ç¤ºè™šæ‹Ÿå†…å­˜å¤§å°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå†…æ ¸å‚æ•°ã€‚elasticsearch é»˜è®¤è¦æ±‚ <code>vm.max_map_count</code> ä¸ä½äº 262144ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]
</code></pre></div><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p> <p>ä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè®¾ç½® <code>vm.max_map_count</code> ï¼Œä½†æ˜¯é‡å¯ååˆä¼šæ¢å¤ä¸ºåŸå€¼ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>sysctl -w vm.max_map_count=262144
</code></pre></div><p>æŒä¹…æ€§çš„åšæ³•æ˜¯åœ¨ <code>/etc/sysctl.conf</code> æ–‡ä»¶ä¸­ä¿®æ”¹ <code>vm.max_map_count</code> å‚æ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;vm.max_map_count=262144&quot; &gt; /etc/sysctl.conf
sysctl -p
</code></pre></div><blockquote><p><strong>æ³¨æ„</strong></p> <p>å¦‚æœè¿è¡Œç¯å¢ƒä¸º docker å®¹å™¨ï¼Œå¯èƒ½ä¼šé™åˆ¶æ‰§è¡Œ sysctl æ¥ä¿®æ”¹å†…æ ¸å‚æ•°ã€‚</p> <p>è¿™ç§æƒ…å†µä¸‹ï¼Œä½ åªèƒ½é€‰æ‹©ç›´æ¥ä¿®æ”¹å®¿ä¸»æœºä¸Šçš„å‚æ•°äº†ã€‚</p></blockquote> <h3 id="_4-3-nofile-ä¸ä½äº-65536"><a href="#_4-3-nofile-ä¸ä½äº-65536" class="header-anchor">#</a> 4.3. nofile ä¸ä½äº 65536</h3> <p><strong>é—®é¢˜ï¼š</strong> <code>nofile</code> è¡¨ç¤ºè¿›ç¨‹å…è®¸æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ã€‚elasticsearch è¿›ç¨‹è¦æ±‚å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ä¸ä½äº 65536ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>max file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]
</code></pre></div><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p> <p>åœ¨ <code>/etc/security/limits.conf</code> æ–‡ä»¶ä¸­ä¿®æ”¹ <code>nofile</code> å‚æ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;* soft nofile 65536&quot; &gt; /etc/security/limits.conf
echo &quot;* hard nofile 131072&quot; &gt; /etc/security/limits.conf
</code></pre></div><h3 id="_4-4-nproc-ä¸ä½äº-2048"><a href="#_4-4-nproc-ä¸ä½äº-2048" class="header-anchor">#</a> 4.4. nproc ä¸ä½äº 2048</h3> <p><strong>é—®é¢˜ï¼š</strong> <code>nproc</code> è¡¨ç¤ºæœ€å¤§çº¿ç¨‹æ•°ã€‚elasticsearch è¦æ±‚æœ€å¤§çº¿ç¨‹æ•°ä¸ä½äº 2048ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>max number of threads [1024] for user [user] is too low, increase to at least [2048]
</code></pre></div><p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p> <p>åœ¨ <code>/etc/security/limits.conf</code> æ–‡ä»¶ä¸­ä¿®æ”¹ <code>nproc</code> å‚æ•°ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>echo &quot;* soft nproc 2048&quot; &gt; /etc/security/limits.conf
echo &quot;* hard nproc 4096&quot; &gt; /etc/security/limits.conf
</code></pre></div><h2 id="_5-å‚è€ƒèµ„æ–™"><a href="#_5-å‚è€ƒèµ„æ–™" class="header-anchor">#</a> 5. å‚è€ƒèµ„æ–™</h2> <ul><li><a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener noreferrer">Elasticsearch å®˜æ–¹ä¸‹è½½å®‰è£…è¯´æ˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html#rpm" target="_blank" rel="noopener noreferrer">Install Elasticsearch with RPM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://siye1982.github.io/2015/09/17/es-optimize/" target="_blank" rel="noopener noreferrer">Elasticsearch ä½¿ç”¨ç§¯ç´¯<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <div class="page-slot page-slot-bottom">
  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>
  <style>
    .pageB img{width:80px!important;}
    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}
  </style>
  </div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/db-tutorial/edit/master/docs/07.æœç´¢å¼•æ“æ•°æ®åº“/01.Elasticsearch/20.Elasticsearchè¿ç»´.md" target="_blank" rel="noopener noreferrer">ğŸ“ å¸®åŠ©æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/db-tutorial/tags/?tag=%E6%95%B0%E6%8D%AE%E5%BA%93" title="æ ‡ç­¾">#æ•°æ®åº“</a><a href="/db-tutorial/tags/?tag=%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E6%95%B0%E6%8D%AE%E5%BA%93" title="æ ‡ç­¾">#æœç´¢å¼•æ“æ•°æ®åº“</a><a href="/db-tutorial/tags/?tag=Elasticsearch" title="æ ‡ç­¾">#Elasticsearch</a><a href="/db-tutorial/tags/?tag=%E8%BF%90%E7%BB%B4" title="æ ‡ç­¾">#è¿ç»´</a></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2022/05/26, 20:28:39</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/db-tutorial/pages/d894ac/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Elasticsearch é›†ç¾¤å’Œåˆ†ç‰‡</div></a> <a href="/db-tutorial/pages/d5bdd0/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Elastic å¿«é€Ÿå…¥é—¨</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/db-tutorial/pages/d894ac/" class="prev">Elasticsearch é›†ç¾¤å’Œåˆ†ç‰‡</a></span> <span class="next"><a href="/db-tutorial/pages/d5bdd0/">Elastic å¿«é€Ÿå…¥é—¨</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/db-tutorial/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/db-tutorial/pages/6ed13e/"><div>
            æ•°æ®åº“ç»¼åˆ
            <!----></div></a> <span class="date">04-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/db-tutorial/pages/02d9f1/"><div>
            æ•°æ®åº“ä¸­é—´ä»¶å’Œä»£ç†
            <!----></div></a> <span class="date">04-11</span></dt></dl><dl><dd>03</dd> <dt><a href="/db-tutorial/pages/b2560d/"><div>
            å…³ç³»å‹æ•°æ®åº“å…¶ä»–çŸ¥è¯†
            <!----></div></a> <span class="date">04-11</span></dt></dl> <dl><dd></dd> <dt><a href="/db-tutorial/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:forbreak@163.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/dunwu" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2022
    <span>é’æ‚Ÿï¼ˆdunwuï¼‰ | CC-BY-SA-4.0</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">Ã—</span> <div>
    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;
    min-width: auto;min-height:auto;"></div>
    <style>
      .windowRB{ padding: 0;}
      .windowRB .wwads-img{margin-top: 10px;}
      .windowRB .wwads-content{margin: 0 10px 10px 10px;}
      .custom-html-window-rb .close-but{
        display: none;
      }
    </style>
  </div></div></div></div><div class="global-ui"></div></div>
    <script src="/db-tutorial/assets/js/app.940dcc4d.js" defer></script><script src="/db-tutorial/assets/js/2.4e32ee2e.js" defer></script><script src="/db-tutorial/assets/js/67.038a8a89.js" defer></script>
  </body>
</html>
